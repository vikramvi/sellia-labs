{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport { firebaseAuth } from './init';\nimport { setFirebaseCookie } from './session';\n/**\n * Firebase Authentication helper functions\n */\n\nvar AuthHelper = function AuthHelper() {\n  var _this = this;\n\n  _classCallCheck(this, AuthHelper);\n\n  _defineProperty(this, \"signUp\",\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(provider, email, password) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.t0 = provider;\n              _context.next = _context.t0 === 'password' ? 4 : 5;\n              break;\n\n            case 4:\n              return _context.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                firebaseAuth().createUserWithEmailAndPassword(email, password).then(function (result) {\n                  resolve(result);\n                })[\"catch\"](function (error) {\n                  resolve({\n                    error: error\n                  });\n                });\n              }));\n\n            case 5:\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t1 = _context[\"catch\"](0);\n              console.log(_context.t1);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n\n    return function (_x, _x2, _x3) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"forgetPass\",\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(email) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              return _context2.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                firebaseAuth().sendPasswordResetEmail(email).then(function (result) {\n                  resolve(true);\n                })[\"catch\"](function (error) {\n                  resolve({\n                    error: error\n                  });\n                });\n              }));\n\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"reauthenticate\",\n  /*#__PURE__*/\n  function () {\n    var _ref3 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3(currentPassword) {\n      var user, cred;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              user = firebaseAuth().currentUser;\n              cred = firebaseAuth.EmailAuthProvider.credential(user.email, currentPassword);\n              return _context3.abrupt(\"return\", user.reauthenticateWithCredential(cred));\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x5) {\n      return _ref3.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"changePassword\",\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4(currentPassword, newPassword) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              return _context4.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                try {\n                  _this.reauthenticate(currentPassword).then(function () {\n                    var user = firebaseAuth().currentUser;\n                    user.updatePassword(newPassword).then(function () {\n                      resolve(true);\n                    })[\"catch\"](function (error) {\n                      resolve({\n                        error: error\n                      });\n                    });\n                  })[\"catch\"](function (error) {\n                    resolve({\n                      error: error\n                    });\n                  });\n                } catch (error) {\n                  resolve({\n                    error: error\n                  });\n                }\n              }));\n\n            case 1:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function (_x6, _x7) {\n      return _ref4.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"login\",\n  /*#__PURE__*/\n  function () {\n    var _ref5 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee5(provider) {\n      var email,\n          password,\n          phoneNumber,\n          authProvider,\n          appVerifier,\n          _args5 = arguments;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              email = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : null;\n              password = _args5.length > 2 && _args5[2] !== undefined ? _args5[2] : null;\n              phoneNumber = _args5.length > 3 && _args5[3] !== undefined ? _args5[3] : null;\n              _context5.prev = 3;\n              _context5.t0 = provider;\n              _context5.next = _context5.t0 === 'password' ? 7 : _context5.t0 === 'google' ? 8 : _context5.t0 === 'facebook' ? 10 : _context5.t0 === 'twitter' ? 12 : _context5.t0 === 'phone' ? 14 : 16;\n              break;\n\n            case 7:\n              return _context5.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                firebaseAuth().signInWithEmailAndPassword(email, password).then(function (result) {\n                  resolve(result);\n                })[\"catch\"](function (error) {\n                  resolve({\n                    error: error\n                  });\n                });\n              }));\n\n            case 8:\n              authProvider = new firebaseAuth.GoogleAuthProvider();\n              return _context5.abrupt(\"return\", firebaseAuth().signInWithPopup(authProvider));\n\n            case 10:\n              authProvider = new firebaseAuth.FacebookAuthProvider();\n              return _context5.abrupt(\"return\", firebaseAuth().signInWithPopup(authProvider));\n\n            case 12:\n              authProvider = new firebaseAuth.TwitterAuthProvider();\n              return _context5.abrupt(\"return\", firebaseAuth().signInWithPopup(authProvider));\n\n            case 14:\n              appVerifier = window.recaptchaVerifier;\n              return _context5.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                firebaseAuth().signInWithPhoneNumber(phoneNumber, appVerifier).then(function (result) {\n                  resolve(result);\n                })[\"catch\"](function (error) {\n                  resolve({\n                    error: error\n                  });\n                });\n              }));\n\n            case 16:\n              _context5.next = 21;\n              break;\n\n            case 18:\n              _context5.prev = 18;\n              _context5.t1 = _context5[\"catch\"](3);\n              console.error(_context5.t1);\n\n            case 21:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[3, 18]]);\n    }));\n\n    return function (_x8) {\n      return _ref5.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"confirmVerification\",\n  /*#__PURE__*/\n  function () {\n    var _ref6 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee6(confirmationResult, code) {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              return _context6.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                confirmationResult.confirm(code).then(function (result) {\n                  resolve(result.user);\n                })[\"catch\"](function (error) {\n                  resolve({\n                    error: error\n                  });\n                });\n              }));\n\n            case 1:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function (_x9, _x10) {\n      return _ref6.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"getToken\",\n  /*#__PURE__*/\n  function () {\n    var _ref7 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee7(User) {\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.prev = 0;\n              return _context7.abrupt(\"return\", User.getIdToken());\n\n            case 4:\n              _context7.prev = 4;\n              _context7.t0 = _context7[\"catch\"](0);\n              console.log(_context7.t0);\n\n            case 7:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7, null, [[0, 4]]);\n    }));\n\n    return function (_x11) {\n      return _ref7.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"refreshToken\",\n  /*#__PURE__*/\n  _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee8() {\n    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            _context8.next = 2;\n            return firebaseAuth().currentUser.getIdToken(true).then(function (idToken) {\n              setFirebaseCookie('id_token', idToken);\n            })[\"catch\"](function (error) {});\n\n          case 2:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  })));\n\n  _defineProperty(this, \"logout\",\n  /*#__PURE__*/\n  _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee9() {\n    return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            return _context9.abrupt(\"return\", new _Promise(function (resolve, reject) {\n              try {\n                firebaseAuth().signOut().then(function () {\n                  resolve(true);\n                });\n              } catch (error) {\n                reject(false);\n              }\n            }));\n\n          case 1:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, _callee9);\n  })));\n\n  _defineProperty(this, \"isAuthenticated\",\n  /*#__PURE__*/\n  _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee10() {\n    return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n      while (1) {\n        switch (_context10.prev = _context10.next) {\n          case 0:\n            return _context10.abrupt(\"return\", new _Promise(function (resolve, reject) {\n              var unsubscribe = firebaseAuth().onAuthStateChanged(function (authUser) {\n                resolve(authUser);\n                unsubscribe();\n              }, function (error) {\n                return reject(error);\n              });\n            }));\n\n          case 1:\n          case \"end\":\n            return _context10.stop();\n        }\n      }\n    }, _callee10);\n  })));\n\n  _defineProperty(this, \"getCurrentUser\",\n  /*#__PURE__*/\n  _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee11() {\n    return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n      while (1) {\n        switch (_context11.prev = _context11.next) {\n          case 0:\n            return _context11.abrupt(\"return\", firebaseAuth().currentUser);\n\n          case 1:\n          case \"end\":\n            return _context11.stop();\n        }\n      }\n    }, _callee11);\n  })));\n};\n\nexport default new AuthHelper();","map":null,"metadata":{},"sourceType":"module"}