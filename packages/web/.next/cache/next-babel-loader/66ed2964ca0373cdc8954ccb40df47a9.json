{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport { getThumbUrl } from './generateThumbUrl';\nimport { storage } from './init';\n/**\n * Helper functions to upload multiple image to firebase storage\n * @param {Array} images\n */\n\nexport function uploadMultipleImages(_x) {\n  return _uploadMultipleImages.apply(this, arguments);\n}\n\nfunction _uploadMultipleImages() {\n  _uploadMultipleImages = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(images) {\n    var allImages, uploadedImages;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            allImages = [];\n\n            storage.ref().constructor.prototype.putFiles = function (files) {\n              var ref = this;\n              return _Promise.all(files.map(function (file) {\n                return ref.child(file.name).put(file);\n              }));\n            };\n\n            _context2.next = 4;\n            return storage.ref().putFiles(images).then(function (metadatas) {\n              return metadatas;\n            });\n\n          case 4:\n            uploadedImages = _context2.sent;\n            return _context2.abrupt(\"return\", _Promise.all(uploadedImages.map(function (snapshot) {\n              return new _Promise(\n              /*#__PURE__*/\n              function () {\n                var _ref = _asyncToGenerator(\n                /*#__PURE__*/\n                _regeneratorRuntime.mark(function _callee(resolve, reject) {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          _context.next = 2;\n                          return snapshot.ref.getDownloadURL().then(function (downloadURL) {\n                            var thumbUrl = getThumbUrl(downloadURL);\n                            allImages.push({\n                              url: thumbUrl,\n                              largeUrl: downloadURL\n                            });\n                          });\n\n                        case 2:\n                          resolve(allImages);\n\n                        case 3:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                }));\n\n                return function (_x2, _x3) {\n                  return _ref.apply(this, arguments);\n                };\n              }());\n            })));\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _uploadMultipleImages.apply(this, arguments);\n}","map":{"version":3,"sources":["/Users/bhavikshah/Work/headless-graphql/packages/web/helpers/uploadMultipleImage.js"],"names":["getThumbUrl","storage","uploadMultipleImages","images","allImages","ref","constructor","prototype","putFiles","files","all","map","file","child","name","put","then","metadatas","uploadedImages","snapshot","resolve","reject","getDownloadURL","downloadURL","thumbUrl","push","url","largeUrl"],"mappings":";;;AAAA,SAASA,WAAT,QAA4B,oBAA5B;AACA,SAASC,OAAT,QAAwB,QAAxB;AAEA;;;;;AAIA,gBAAsBC,oBAAtB;AAAA;AAAA;;;;;2BAAO,kBAAoCC,MAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AACDC,YAAAA,SADC,GACW,EADX;;AAELH,YAAAA,OAAO,CAACI,GAAR,GAAcC,WAAd,CAA0BC,SAA1B,CAAoCC,QAApC,GAA+C,UAASC,KAAT,EAAgB;AAC7D,kBAAIJ,GAAG,GAAG,IAAV;AACA,qBAAO,SAAQK,GAAR,CACLD,KAAK,CAACE,GAAN,CAAU,UAASC,IAAT,EAAe;AACvB,uBAAOP,GAAG,CAACQ,KAAJ,CAAUD,IAAI,CAACE,IAAf,EAAqBC,GAArB,CAAyBH,IAAzB,CAAP;AACD,eAFD,CADK,CAAP;AAKD,aAPD;;AAFK;AAAA,mBAUwBX,OAAO,CACjCI,GAD0B,GAE1BG,QAF0B,CAEjBL,MAFiB,EAG1Ba,IAH0B,CAGrB,UAASC,SAAT,EAAoB;AACxB,qBAAOA,SAAP;AACD,aAL0B,CAVxB;;AAAA;AAUCC,YAAAA,cAVD;AAAA,8CAiBE,SAAQR,GAAR,CACLQ,cAAc,CAACP,GAAf,CAAmB,UAAAQ,QAAQ,EAAI;AAC7B,qBAAO;AAAA;AAAA;AAAA;AAAA;AAAA,yCAAY,iBAAOC,OAAP,EAAgBC,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCACXF,QAAQ,CAACd,GAAT,CAAaiB,cAAb,GAA8BN,IAA9B,CAAmC,UAASO,WAAT,EAAsB;AAC7D,gCAAMC,QAAQ,GAAGxB,WAAW,CAACuB,WAAD,CAA5B;AACAnB,4BAAAA,SAAS,CAACqB,IAAV,CAAe;AACbC,8BAAAA,GAAG,EAAEF,QADQ;AAEbG,8BAAAA,QAAQ,EAAEJ;AAFG,6BAAf;AAID,2BANK,CADW;;AAAA;AAQjBH,0BAAAA,OAAO,CAAChB,SAAD,CAAP;;AARiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAZ;;AAAA;AAAA;AAAA;AAAA,kBAAP;AAUD,aAXD,CADK,CAjBF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import { getThumbUrl } from './generateThumbUrl';\nimport { storage } from './init';\n\n/**\n * Helper functions to upload multiple image to firebase storage\n * @param {Array} images\n */\nexport async function uploadMultipleImages(images) {\n  let allImages = [];\n  storage.ref().constructor.prototype.putFiles = function(files) {\n    var ref = this;\n    return Promise.all(\n      files.map(function(file) {\n        return ref.child(file.name).put(file);\n      })\n    );\n  };\n  const uploadedImages = await storage\n    .ref()\n    .putFiles(images)\n    .then(function(metadatas) {\n      return metadatas;\n    });\n\n  return Promise.all(\n    uploadedImages.map(snapshot => {\n      return new Promise(async (resolve, reject) => {\n        await snapshot.ref.getDownloadURL().then(function(downloadURL) {\n          const thumbUrl = getThumbUrl(downloadURL);\n          allImages.push({\n            url: thumbUrl,\n            largeUrl: downloadURL,\n          });\n        });\n        resolve(allImages);\n      });\n    })\n  );\n}\n"]},"metadata":{},"sourceType":"module"}