{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/bhavikshah/Work/Sellia/sellia-mono/selliafemono/packages/web/containers/SignInForm/index.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport Router from 'next/router';\nimport { withFormik } from 'formik';\nimport * as Yup from 'yup';\nimport Icon from 'react-icons-kit';\nimport { locked } from 'react-icons-kit/iconic/locked';\nimport { phone } from 'react-icons-kit/iconic/phone';\nimport Switch from 'reusecore/src/elements/Switch';\nimport Text from 'reusecore/src/elements/Text';\nimport Button from 'reusecore/src/elements/Button';\nimport AuthHeader from '../../components/AuthHeader';\nimport Input from '../../components/Input';\nimport Box from 'reusecore/src/elements/Box';\nimport { FormGroup, ErrorNotification } from './style';\nimport { LOGIN } from 'core/graphql/Mutations';\nimport { useMutation } from '@apollo/react-hooks';\nimport AuthHelper from '../../helpers/authHelper';\nimport { setFirebaseCookie } from '../../helpers/session';\nimport redirect from '../../helpers/redirect';\nvar SignInEnhancher = withFormik({\n  enableReinitialize: true,\n  mapPropsToValues: function mapPropsToValues(props) {\n    return {\n      email: '',\n      password: '',\n      remember: false\n    };\n  },\n  validationSchema: Yup.object().shape({\n    email: Yup.string().email('Invalid email address').required('Email is required!'),\n    password: Yup.string().required('Password is required')\n  })\n});\nvar token = '';\n\nvar SignInForm = function SignInForm(_ref) {\n  _s();\n\n  var handleSubmit = _ref.handleSubmit,\n      values = _ref.values,\n      handleChange = _ref.handleChange,\n      touched = _ref.touched,\n      errors = _ref.errors,\n      setFieldValue = _ref.setFieldValue,\n      handleBlur = _ref.handleBlur;\n\n  var _useState = useState({}),\n      error = _useState[0],\n      setError = _useState[1];\n\n  var _useState2 = useState(false),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var handleCheckboxChange = function handleCheckboxChange(checked) {\n    setFieldValue('remember', checked);\n  };\n\n  var _useMutation = useMutation(LOGIN),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      loginMutation = _useMutation2[0],\n      data = _useMutation2[1].data;\n\n  handleSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var email, password, provider, _yield$AuthHelper$log, user, _error;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n\n              if (Object.keys(errors).length) {\n                _context.next = 19;\n                break;\n              }\n\n              email = values.email, password = values.password;\n              provider = 'password';\n              _context.next = 6;\n              return AuthHelper.login(provider, email, password);\n\n            case 6:\n              _yield$AuthHelper$log = _context.sent;\n              user = _yield$AuthHelper$log.user;\n              _error = _yield$AuthHelper$log.error;\n\n              if (!user) {\n                _context.next = 16;\n                break;\n              }\n\n              _context.next = 12;\n              return user.getIdToken();\n\n            case 12:\n              token = _context.sent;\n              setFieldValue('token', token);\n              _context.next = 17;\n              break;\n\n            case 16:\n              if (_error) {\n                setLoading(false);\n                setError(_error);\n              }\n\n            case 17:\n              _context.next = 20;\n              break;\n\n            case 19:\n              setLoading(false);\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSubmit() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var res, user;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n\n              if (!values.token) {\n                _context2.next = 6;\n                break;\n              }\n\n              _context2.next = 4;\n              return loginMutation({\n                variables: {\n                  user: {\n                    email: values.email,\n                    token: values.token\n                  }\n                }\n              });\n\n            case 4:\n              res = _context2.sent;\n\n              if (res && res.data && res.data.login) {\n                setLoading(false);\n                user = res.data.login;\n                setFirebaseCookie('id_token', values.token);\n                setFirebaseCookie('user', _objectSpread({}, user));\n                redirect({}, '/');\n              }\n\n            case 6:\n              _context2.next = 12;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](0);\n              setLoading(false);\n              return _context2.abrupt(\"return\", _context2.t0);\n\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 8]]);\n    }))();\n  }, [values.token]);\n  return __jsx(React.Fragment, null, __jsx(AuthHeader, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }\n  }), __jsx(FormGroup, {\n    className: errors.email ? 'hasErrorMsg' : '',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, __jsx(Input, {\n    elementType: \"input\",\n    elementConfig: {\n      type: 'email',\n      required: 'required'\n    },\n    onBlur: handleBlur('email'),\n    value: values.email,\n    error: errors.email,\n    touched: touched,\n    label: \"Email\",\n    changed: handleChange('email'),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }), __jsx(\"span\", {\n    className: \"errorMsg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }\n  }, errors.email && touched.email && errors.email)), __jsx(FormGroup, {\n    className: errors.password ? 'hasErrorMsg' : '',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }, __jsx(Input, {\n    elementType: \"input\",\n    elementConfig: {\n      type: 'password',\n      required: 'required'\n    },\n    onBlur: handleBlur('password'),\n    value: values.password,\n    error: errors.password,\n    touched: touched,\n    label: \"Password\",\n    changed: handleChange('password'),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }), __jsx(\"span\", {\n    className: \"errorMsg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, errors.password && touched.password && errors.password)), error.message ? __jsx(Box, {\n    flexBox: true,\n    mt: 25,\n    mb: 35,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 9\n    }\n  }, __jsx(ErrorNotification, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 11\n    }\n  }, error.message)) : '', __jsx(Button //disabled={errors.length !== 0}\n  , {\n    onClick: handleSubmit,\n    isLoading: loading,\n    loaderColor: \"#fff\",\n    title: \"Sign in now\",\n    width: 1,\n    icon: __jsx(Icon, {\n      icon: locked,\n      size: 16,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 15\n      }\n    }),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }\n  }), __jsx(Text, {\n    fontSize: 14,\n    color: \"#8C8C8C\",\n    content: \"Or\",\n    textAlign: \"center\",\n    mt: 16,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }\n  }), __jsx(Button, {\n    title: \"Sign in with\",\n    bg: \"#5CABE6\",\n    width: 1,\n    icon: __jsx(Icon, {\n      icon: phone,\n      size: 16,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 15\n      }\n    }),\n    onClick: function onClick() {\n      return Router.push('/mobile-signin');\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }\n  }), __jsx(Box, {\n    flexBox: true,\n    mb: 25,\n    mt: 25,\n    justifyContent: \"center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }\n  }, __jsx(Button, {\n    fontSize: 12,\n    title: \"Forgot Password ?\",\n    variant: \"textButton\",\n    onClick: function onClick() {\n      return Router.push('/forget-password');\n    },\n    style: {\n      minHeight: 'auto'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 9\n    }\n  })), __jsx(Box, {\n    flexBox: true,\n    mt: 0,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    flexWrap: \"wrap\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }\n  }, __jsx(Text, {\n    color: \"#8C8C8C\",\n    content: \"Don't have an account?\",\n    mb: \"5px\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 9\n    }\n  }), __jsx(Button, {\n    title: \"Sign Up\",\n    ml: \"5px\",\n    mb: \"5px\",\n    variant: \"textButton\",\n    onClick: function onClick() {\n      return Router.push('/signup');\n    },\n    style: {\n      minHeight: 'auto'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 9\n    }\n  })));\n};\n\n_s(SignInForm, \"rzgfV3l4srtB2CAygBiaK0ihgOQ=\", false, function () {\n  return [useMutation];\n});\n\n_c = SignInForm;\nexport default _c2 = SignInEnhancher(SignInForm);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"SignInForm\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/bhavikshah/Work/Sellia/sellia-mono/selliafemono/packages/web/containers/SignInForm/index.js"],"names":["React","useEffect","useState","Router","withFormik","Yup","Icon","locked","phone","Switch","Text","Button","AuthHeader","Input","Box","FormGroup","ErrorNotification","LOGIN","useMutation","AuthHelper","setFirebaseCookie","redirect","SignInEnhancher","enableReinitialize","mapPropsToValues","props","email","password","remember","validationSchema","object","shape","string","required","token","SignInForm","handleSubmit","values","handleChange","touched","errors","setFieldValue","handleBlur","error","setError","loading","setLoading","handleCheckboxChange","checked","loginMutation","data","Object","keys","length","provider","login","user","getIdToken","variables","res","type","message","push","minHeight"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Router from 'next/router';\nimport { withFormik } from 'formik';\nimport * as Yup from 'yup';\nimport Icon from 'react-icons-kit';\nimport { locked } from 'react-icons-kit/iconic/locked';\nimport { phone } from 'react-icons-kit/iconic/phone';\nimport Switch from 'reusecore/src/elements/Switch';\nimport Text from 'reusecore/src/elements/Text';\nimport Button from 'reusecore/src/elements/Button';\nimport AuthHeader from '../../components/AuthHeader';\nimport Input from '../../components/Input';\nimport Box from 'reusecore/src/elements/Box';\nimport { FormGroup, ErrorNotification } from './style';\nimport { LOGIN } from 'core/graphql/Mutations';\nimport { useMutation } from '@apollo/react-hooks';\nimport AuthHelper from '../../helpers/authHelper';\nimport { setFirebaseCookie } from '../../helpers/session';\nimport redirect from '../../helpers/redirect';\n\nconst SignInEnhancher = withFormik({\n  enableReinitialize: true,\n  mapPropsToValues: props => ({ email: '', password: '', remember: false }),\n  validationSchema: Yup.object().shape({\n    email: Yup.string()\n      .email('Invalid email address')\n      .required('Email is required!'),\n    password: Yup.string().required('Password is required'),\n  }),\n});\nlet token = '';\nconst SignInForm = ({\n  handleSubmit,\n  values,\n  handleChange,\n  touched,\n  errors,\n  setFieldValue,\n  handleBlur,\n}) => {\n  const [error, setError] = useState({});\n  const [loading, setLoading] = useState(false);\n  const handleCheckboxChange = checked => {\n    setFieldValue('remember', checked);\n  };\n\n  const [loginMutation, { data }] = useMutation(LOGIN);\n\n  handleSubmit = async () => {\n    setLoading(true);\n    if (!Object.keys(errors).length) {\n      const { email, password } = values;\n      const provider = 'password';\n      const { user, error } = await AuthHelper.login(provider, email, password);\n      if (user) {\n        token = await user.getIdToken();\n        setFieldValue('token', token);\n      } else if (error) {\n        setLoading(false);\n        setError(error);\n      }\n    } else {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    (async function() {\n      try {\n        if (values.token) {\n          const res = await loginMutation({\n            variables: { user: { email: values.email, token: values.token } },\n          });\n          if (res && res.data && res.data.login) {\n            setLoading(false);\n            const user = res.data.login;\n            setFirebaseCookie('id_token', values.token);\n            setFirebaseCookie('user', { ...user });\n            redirect({}, '/');\n          }\n        }\n      } catch (error) {\n        setLoading(false);\n        return error;\n      }\n    })();\n  }, [values.token]);\n\n  return (\n    <>\n      {/* auth page header section */}\n      <AuthHeader />\n      {/* signin form */}\n      <FormGroup className={errors.email ? 'hasErrorMsg' : ''}>\n        <Input\n          elementType=\"input\"\n          elementConfig={{\n            type: 'email',\n            required: 'required',\n          }}\n          onBlur={handleBlur('email')}\n          value={values.email}\n          error={errors.email}\n          touched={touched}\n          label=\"Email\"\n          changed={handleChange('email')}\n        />\n        <span className=\"errorMsg\">\n          {errors.email && touched.email && errors.email}\n        </span>\n      </FormGroup>\n      <FormGroup className={errors.password ? 'hasErrorMsg' : ''}>\n        <Input\n          elementType=\"input\"\n          elementConfig={{\n            type: 'password',\n            required: 'required',\n          }}\n          onBlur={handleBlur('password')}\n          value={values.password}\n          error={errors.password}\n          touched={touched}\n          label=\"Password\"\n          changed={handleChange('password')}\n        />\n        <span className=\"errorMsg\">\n          {errors.password && touched.password && errors.password}\n        </span>\n      </FormGroup>\n\n      {error.message ? (\n        <Box\n          flexBox\n          mt={25}\n          mb={35}\n          justifyContent=\"center\"\n          alignItems=\"center\"\n        >\n          <ErrorNotification>{error.message}</ErrorNotification>\n        </Box>\n      ) : (\n        ''\n      )}\n\n      <Button\n        //disabled={errors.length !== 0}\n\n        onClick={handleSubmit}\n        isLoading={loading}\n        loaderColor=\"#fff\"\n        title=\"Sign in now\"\n        width={1}\n        icon={<Icon icon={locked} size={16} />}\n      />\n      {/* separator text */}\n      <Text\n        fontSize={14}\n        color=\"#8C8C8C\"\n        content=\"Or\"\n        textAlign=\"center\"\n        mt={16}\n      />\n\n      <Button\n        title=\"Sign in with\"\n        bg=\"#5CABE6\"\n        width={1}\n        icon={<Icon icon={phone} size={16} />}\n        onClick={() => Router.push('/mobile-signin')}\n      />\n\n      <Box flexBox mb={25} mt={25} justifyContent=\"center\">\n        {/* <Switch\n          isChecked={false}\n          isMaterial\n          switchSize=\"40px\"\n          handleSwitch={checked => handleCheckboxChange(checked)}\n          labelText=\"Remember Me\"\n          labelPosition=\"right\"\n          fontSize={12}\n        /> */}\n\n        <Button\n          fontSize={12}\n          title=\"Forgot Password ?\"\n          variant=\"textButton\"\n          onClick={() => Router.push('/forget-password')}\n          style={{\n            minHeight: 'auto',\n          }}\n        />\n      </Box>\n\n      {/* signup page redirection section */}\n      <Box\n        flexBox\n        mt={0}\n        justifyContent=\"center\"\n        alignItems=\"center\"\n        flexWrap=\"wrap\"\n      >\n        <Text color=\"#8C8C8C\" content=\"Don't have an account?\" mb=\"5px\" />\n        <Button\n          title=\"Sign Up\"\n          ml=\"5px\"\n          mb=\"5px\"\n          variant=\"textButton\"\n          onClick={() => Router.push('/signup')}\n          style={{\n            minHeight: 'auto',\n          }}\n        />\n      </Box>\n    </>\n  );\n};\n\nexport default SignInEnhancher(SignInForm);\n"]},"metadata":{},"sourceType":"module"}