{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport { useState } from 'react';\nimport Link from 'next/link';\nimport { Grid } from 'react-styled-flexboxgrid';\nimport { useQuery } from '@apollo/react-hooks';\nimport { GET_CATEGORIES } from 'core/graphql/Category.query';\nimport { SINGLE_CATEGORY_PAGE } from 'core/navigation/constant';\nimport withLayout from '../hoc/withLayout';\nimport { CategoryGridCard } from '../components/CategoryCard';\nimport Box from 'reusecore/src/elements/Box';\nimport ListGrid from 'reusecore/src/elements/ListGrid';\nimport CategoryLoader from '../components/Loader/CategoryLoader';\nimport PageMeta from '../components/PageMeta';\nimport Heading from 'reusecore/src/elements/Heading';\nimport NoItemFound from '../components/NoItemFound';\nimport OnError from '../components/OnError';\nimport { withApollo } from '../helpers/apollo';\nexport default withApollo(withLayout(() => {\n  const {\n    0: loadingMore,\n    1: toggleLoading\n  } = useState(false);\n  const {\n    0: page,\n    1: paginate\n  } = useState(1);\n  let QUERY_VARIABLES = {\n    LIMIT: 20\n  };\n  const {\n    data,\n    loading,\n    error,\n    fetchMore\n  } = useQuery(GET_CATEGORIES, {\n    variables: QUERY_VARIABLES\n  });\n  if (error) return __jsx(OnError, null);\n  const categoryCount = data && data.categories && data.categories.data ? data.categories.data.length : 1;\n  const categories = data && data.categories && data.categories.data ? data.categories.data : [];\n  const totalCategory = data && data.categories ? data.categories.total : 1;\n\n  const renderCategoryItem = item => {\n    const {\n      slug,\n      image: {\n        url\n      },\n      name,\n      posts\n    } = item;\n    const postNumber = posts ? posts.total : '';\n    return __jsx(Link, {\n      href: `${SINGLE_CATEGORY_PAGE}/[slug]`,\n      as: `${SINGLE_CATEGORY_PAGE}/${slug}`\n    }, __jsx(\"a\", null, __jsx(CategoryGridCard, {\n      imageSrc: url,\n      title: name,\n      postNumber: `${postNumber} post`,\n      height: \"auto\",\n      mb: \"2rem\",\n      boxShadow: \"1px 3px 15px rgba(0, 0, 0, 0.05)\",\n      border: \"none\"\n    })));\n  };\n\n  return __jsx(React.Fragment, null, __jsx(PageMeta, {\n    title: \"Categories\",\n    description: \"Categories\"\n  }), __jsx(Box, {\n    pt: 70,\n    pb: 70\n  }, __jsx(Grid, null, __jsx(Heading, {\n    content: \"Categories\",\n    mb: 40,\n    style: {\n      fontSize: 24,\n      fontWeight: 600,\n      color: '#333333'\n    }\n  }), !categories.length && !loading ? __jsx(NoItemFound, null) : __jsx(ListGrid, {\n    data: categories,\n    totalPost: totalCategory,\n    postCount: categoryCount,\n    columnWidth: [1, 1 / 2, 1 / 4],\n    component: renderCategoryItem,\n    loading: loading ? loading : loadingMore,\n    placeholder: __jsx(CategoryLoader, null),\n    limit: QUERY_VARIABLES.LIMIT,\n    handleLoadMore: () => {\n      toggleLoading(true);\n      paginate(page + 1);\n      fetchMore({\n        variables: {\n          page: page + 1\n        },\n        updateQuery: (prev, {\n          fetchMoreResult\n        }) => {\n          if (!fetchMoreResult) {\n            toggleLoading(false);\n            return prev;\n          }\n\n          if (categoryCount && totalCategory) {\n            if (categoryCount <= totalCategory) {\n              toggleLoading(false);\n              return Object.assign({}, prev, {\n                categories: {\n                  data: [...prev.categories.data, ...fetchMoreResult.categories.data],\n                  total: totalCategory\n                }\n              });\n            }\n          }\n        }\n      });\n    }\n  }))));\n}));","map":null,"metadata":{},"sourceType":"module"}