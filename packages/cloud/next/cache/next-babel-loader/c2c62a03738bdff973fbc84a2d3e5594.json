{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport { firebaseAuth } from './init';\nimport { setFirebaseCookie } from './session';\n/**\n * Firebase Authentication helper functions\n */\n\nvar AuthHelper = function AuthHelper() {\n  var _this = this;\n\n  _classCallCheck(this, AuthHelper);\n\n  _defineProperty(this, \"signUp\",\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(provider, email, password) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.t0 = provider;\n              _context.next = _context.t0 === 'password' ? 4 : 5;\n              break;\n\n            case 4:\n              return _context.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                firebaseAuth().createUserWithEmailAndPassword(email, password).then(function (result) {\n                  resolve(result);\n                })[\"catch\"](function (error) {\n                  resolve({\n                    error: error\n                  });\n                });\n              }));\n\n            case 5:\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t1 = _context[\"catch\"](0);\n              console.log(_context.t1);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n\n    return function (_x, _x2, _x3) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"forgetPass\",\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(email) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              return _context2.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                firebaseAuth().sendPasswordResetEmail(email).then(function (result) {\n                  resolve(true);\n                })[\"catch\"](function (error) {\n                  resolve({\n                    error: error\n                  });\n                });\n              }));\n\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"reauthenticate\",\n  /*#__PURE__*/\n  function () {\n    var _ref3 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3(currentPassword) {\n      var user, cred;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              user = firebaseAuth().currentUser;\n              cred = firebaseAuth.EmailAuthProvider.credential(user.email, currentPassword);\n              return _context3.abrupt(\"return\", user.reauthenticateWithCredential(cred));\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x5) {\n      return _ref3.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"changePassword\",\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4(currentPassword, newPassword) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              return _context4.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                try {\n                  _this.reauthenticate(currentPassword).then(function () {\n                    var user = firebaseAuth().currentUser;\n                    user.updatePassword(newPassword).then(function () {\n                      resolve(true);\n                    })[\"catch\"](function (error) {\n                      resolve({\n                        error: error\n                      });\n                    });\n                  })[\"catch\"](function (error) {\n                    resolve({\n                      error: error\n                    });\n                  });\n                } catch (error) {\n                  resolve({\n                    error: error\n                  });\n                }\n              }));\n\n            case 1:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function (_x6, _x7) {\n      return _ref4.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"login\",\n  /*#__PURE__*/\n  function () {\n    var _ref5 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee5(provider) {\n      var email,\n          password,\n          phoneNumber,\n          authProvider,\n          appVerifier,\n          _args5 = arguments;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              email = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : null;\n              password = _args5.length > 2 && _args5[2] !== undefined ? _args5[2] : null;\n              phoneNumber = _args5.length > 3 && _args5[3] !== undefined ? _args5[3] : null;\n              _context5.prev = 3;\n              _context5.t0 = provider;\n              _context5.next = _context5.t0 === 'password' ? 7 : _context5.t0 === 'google' ? 8 : _context5.t0 === 'facebook' ? 10 : _context5.t0 === 'twitter' ? 12 : _context5.t0 === 'phone' ? 14 : 16;\n              break;\n\n            case 7:\n              return _context5.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                firebaseAuth().signInWithEmailAndPassword(email, password).then(function (result) {\n                  resolve(result);\n                })[\"catch\"](function (error) {\n                  resolve({\n                    error: error\n                  });\n                });\n              }));\n\n            case 8:\n              authProvider = new firebaseAuth.GoogleAuthProvider();\n              return _context5.abrupt(\"return\", firebaseAuth().signInWithPopup(authProvider));\n\n            case 10:\n              authProvider = new firebaseAuth.FacebookAuthProvider();\n              return _context5.abrupt(\"return\", firebaseAuth().signInWithPopup(authProvider));\n\n            case 12:\n              authProvider = new firebaseAuth.TwitterAuthProvider();\n              return _context5.abrupt(\"return\", firebaseAuth().signInWithPopup(authProvider));\n\n            case 14:\n              appVerifier = window.recaptchaVerifier;\n              return _context5.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                firebaseAuth().signInWithPhoneNumber(phoneNumber, appVerifier).then(function (result) {\n                  resolve(result);\n                })[\"catch\"](function (error) {\n                  resolve({\n                    error: error\n                  });\n                });\n              }));\n\n            case 16:\n              _context5.next = 21;\n              break;\n\n            case 18:\n              _context5.prev = 18;\n              _context5.t1 = _context5[\"catch\"](3);\n              console.error(_context5.t1);\n\n            case 21:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[3, 18]]);\n    }));\n\n    return function (_x8) {\n      return _ref5.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"confirmVerification\",\n  /*#__PURE__*/\n  function () {\n    var _ref6 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee6(confirmationResult, code) {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              return _context6.abrupt(\"return\", new _Promise(function (resolve, reject) {\n                confirmationResult.confirm(code).then(function (result) {\n                  resolve(result.user);\n                })[\"catch\"](function (error) {\n                  resolve({\n                    error: error\n                  });\n                });\n              }));\n\n            case 1:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function (_x9, _x10) {\n      return _ref6.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"getToken\",\n  /*#__PURE__*/\n  function () {\n    var _ref7 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee7(User) {\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.prev = 0;\n              return _context7.abrupt(\"return\", User.getIdToken());\n\n            case 4:\n              _context7.prev = 4;\n              _context7.t0 = _context7[\"catch\"](0);\n              console.log(_context7.t0);\n\n            case 7:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7, null, [[0, 4]]);\n    }));\n\n    return function (_x11) {\n      return _ref7.apply(this, arguments);\n    };\n  }());\n\n  _defineProperty(this, \"refreshToken\",\n  /*#__PURE__*/\n  _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee8() {\n    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            _context8.next = 2;\n            return firebaseAuth().currentUser.getIdToken(true).then(function (idToken) {\n              setFirebaseCookie('id_token', idToken);\n            })[\"catch\"](function (error) {});\n\n          case 2:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  })));\n\n  _defineProperty(this, \"logout\",\n  /*#__PURE__*/\n  _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee9() {\n    return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            return _context9.abrupt(\"return\", new _Promise(function (resolve, reject) {\n              try {\n                firebaseAuth().signOut().then(function () {\n                  resolve(true);\n                });\n              } catch (error) {\n                reject(false);\n              }\n            }));\n\n          case 1:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, _callee9);\n  })));\n\n  _defineProperty(this, \"isAuthenticated\",\n  /*#__PURE__*/\n  _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee10() {\n    return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n      while (1) {\n        switch (_context10.prev = _context10.next) {\n          case 0:\n            return _context10.abrupt(\"return\", new _Promise(function (resolve, reject) {\n              var unsubscribe = firebaseAuth().onAuthStateChanged(function (authUser) {\n                resolve(authUser);\n                unsubscribe();\n              }, function (error) {\n                return reject(error);\n              });\n            }));\n\n          case 1:\n          case \"end\":\n            return _context10.stop();\n        }\n      }\n    }, _callee10);\n  })));\n\n  _defineProperty(this, \"getCurrentUser\",\n  /*#__PURE__*/\n  _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee11() {\n    return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n      while (1) {\n        switch (_context11.prev = _context11.next) {\n          case 0:\n            return _context11.abrupt(\"return\", firebaseAuth().currentUser);\n\n          case 1:\n          case \"end\":\n            return _context11.stop();\n        }\n      }\n    }, _callee11);\n  })));\n};\n\nexport default new AuthHelper();","map":{"version":3,"sources":["/Users/bhavikshah/Work/headless-graphql/packages/web/helpers/authHelper.js"],"names":["firebaseAuth","setFirebaseCookie","AuthHelper","provider","email","password","resolve","reject","createUserWithEmailAndPassword","then","result","error","console","log","sendPasswordResetEmail","currentPassword","user","currentUser","cred","EmailAuthProvider","credential","reauthenticateWithCredential","newPassword","reauthenticate","updatePassword","phoneNumber","signInWithEmailAndPassword","authProvider","GoogleAuthProvider","signInWithPopup","FacebookAuthProvider","TwitterAuthProvider","appVerifier","window","recaptchaVerifier","signInWithPhoneNumber","confirmationResult","code","confirm","User","getIdToken","idToken","signOut","unsubscribe","onAuthStateChanged","authUser"],"mappings":"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","sourcesContent":["import { firebaseAuth } from './init';\nimport { setFirebaseCookie } from './session';\n\n/**\n * Firebase Authentication helper functions\n */\nclass AuthHelper {\n  constructor() {}\n\n  signUp = async (provider, email, password) => {\n    try {\n      switch (provider) {\n        case 'password':\n          return new Promise((resolve, reject) => {\n            firebaseAuth()\n              .createUserWithEmailAndPassword(email, password)\n              .then(result => {\n                resolve(result);\n              })\n              .catch(error => {\n                resolve({ error });\n              });\n          });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  forgetPass = async email => {\n    return new Promise((resolve, reject) => {\n      firebaseAuth()\n        .sendPasswordResetEmail(email)\n        .then(result => {\n          resolve(true);\n        })\n        .catch(error => {\n          resolve({ error });\n        });\n    });\n  };\n\n  reauthenticate = async currentPassword => {\n    var user = firebaseAuth().currentUser;\n    var cred = firebaseAuth.EmailAuthProvider.credential(\n      user.email,\n      currentPassword\n    );\n    return user.reauthenticateWithCredential(cred);\n  };\n\n  changePassword = async (currentPassword, newPassword) =>\n    new Promise((resolve, reject) => {\n      try {\n        this.reauthenticate(currentPassword)\n          .then(() => {\n            var user = firebaseAuth().currentUser;\n            user\n              .updatePassword(newPassword)\n              .then(() => {\n                resolve(true);\n              })\n              .catch(error => {\n                resolve({ error });\n              });\n          })\n          .catch(error => {\n            resolve({ error });\n          });\n      } catch (error) {\n        resolve({ error });\n      }\n    });\n\n  login = async (\n    provider,\n    email = null,\n    password = null,\n    phoneNumber = null\n  ) => {\n    try {\n      switch (provider) {\n        case 'password':\n          return new Promise((resolve, reject) => {\n            firebaseAuth()\n              .signInWithEmailAndPassword(email, password)\n              .then(result => {\n                resolve(result);\n              })\n              .catch(error => {\n                resolve({ error });\n              });\n          });\n        case 'google':\n          var authProvider = new firebaseAuth.GoogleAuthProvider();\n          return firebaseAuth().signInWithPopup(authProvider);\n        case 'facebook':\n          var authProvider = new firebaseAuth.FacebookAuthProvider();\n          return firebaseAuth().signInWithPopup(authProvider);\n        case 'twitter':\n          var authProvider = new firebaseAuth.TwitterAuthProvider();\n          return firebaseAuth().signInWithPopup(authProvider);\n        case 'phone':\n          let appVerifier;\n          appVerifier = window.recaptchaVerifier;\n          return new Promise((resolve, reject) => {\n            firebaseAuth()\n              .signInWithPhoneNumber(phoneNumber, appVerifier)\n              .then(result => {\n                resolve(result);\n              })\n              .catch(error => {\n                resolve({ error });\n              });\n          });\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  confirmVerification = async (confirmationResult, code) => {\n    return new Promise((resolve, reject) => {\n      confirmationResult\n        .confirm(code)\n        .then(result => {\n          resolve(result.user);\n        })\n        .catch(function(error) {\n          resolve({ error });\n        });\n    });\n  };\n\n  getToken = async User => {\n    try {\n      return User.getIdToken();\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  refreshToken = async () => {\n    await firebaseAuth()\n      .currentUser.getIdToken(true)\n      .then(function(idToken) {\n        setFirebaseCookie('id_token', idToken);\n      })\n      .catch(function(error) {});\n  };\n\n  logout = async () => {\n    return new Promise((resolve, reject) => {\n      try {\n        firebaseAuth()\n          .signOut()\n          .then(() => {\n            resolve(true);\n          });\n      } catch (error) {\n        reject(false);\n      }\n    });\n  };\n\n  isAuthenticated = async () => {\n    return new Promise((resolve, reject) => {\n      const unsubscribe = firebaseAuth().onAuthStateChanged(\n        authUser => {\n          resolve(authUser);\n          unsubscribe();\n        },\n\n        error => reject(error)\n      );\n    });\n  };\n\n  getCurrentUser = async () => {\n    return firebaseAuth().currentUser;\n  };\n}\n\nexport default new AuthHelper();\n"]},"metadata":{},"sourceType":"module"}